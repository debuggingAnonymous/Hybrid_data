prep_child_for_exec 

{

  bool ok = true;

  if (close_stdin)

    {

      const char inputfile[] = "/dev/null";



      if (close (0) < 0)

	{

	  error (0, errno, _("Cannot close standard input"));

	  ok = false;

	}

      else

	{

	  if (open (inputfile, O_RDONLY

#if defined O_LARGEFILE

		   |O_LARGEFILE

#endif

		   ) < 0)

	    {

	      /* This is not entirely fatal, since

	       * executing the child with a closed

	       * stdin is almost as good as executing it

	       * with its stdin attached to /dev/null.

	       */

	      error (0, errno, "%s", safely_quote_err_filename (0, inputfile));

	      /* do not set ok=false, it is OK to continue anyway. */

	    }

	}

    }



  /* Even if DebugSearch is set, don't announce our change of

   * directory, since we're not going to emit a subsequent

   * announcement of a call to stat() anyway, as we're about to exec

   * something.

   */

  if (0 != restore_cwd (wd))

    {

      error (0, errno, _("Failed to change directory"));

      ok = false;

    }

  return ok;

}

