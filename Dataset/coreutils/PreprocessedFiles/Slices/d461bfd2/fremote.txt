fremote 

{

  bool remote = true;           /* be conservative (poll by default).  */



# if HAVE_FSTATFS && HAVE_STRUCT_STATFS_F_TYPE && defined __linux__

  struct statfs buf;

  int err = fstatfs (fd, &buf);

  if (err != 0)

    {

      /* On at least linux-2.6.38, fstatfs fails with ENOSYS when FD

         is open on a pipe.  Treat that like a remote file.  */

      if (errno != ENOSYS)

        error (0, errno, _("cannot determine location of %s. "

                           "reverting to polling"), quote (name));

    }

  else

    {

      switch (is_local_fs_type (buf.f_type))

        {

        case 0:

          break;

        case -1:

          {

            unsigned long int fs_type = buf.f_type;

            error (0, 0, _("unrecognized file system type 0x%08lx for %s. "

                           "please report this to %s. reverting to polling"),

                   fs_type, quote (name), PACKAGE_BUGREPORT);

            /* Treat as "remote", so caller polls.  */

          }

          break;

        case 1:

          remote = false;

          break;

        default:

          assert (!"unexpected return value from is_local_fs_type");

        }

    }

# endif



  return remote;

}

